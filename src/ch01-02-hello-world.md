## Hello, World!

มาถึงตอนนี้คุณน่าจะติดตั้ง Rust กันเรียบร้อยแล้ว งั้นเรามาเริ่มเขียนโปรแกรมแรกด้วย Rust กันเลยดีกว่า
ซึ่งตามประเพณีเมื่อเราเริ่มเรียนภาษาใหม่ก็ต้องเขียนโปรแกรมเล็กๆ ให้พิมพ์คำว่า `Hello, world!` บนหน้าจอก่อน ซึ่งเราก็จะเริ่มแบบเดียวกัน

> สังเกต: หนังสือเล่มนี้จะใช้คำสั่งพื้นฐานที่ Rust เตรียมไว้ให้แล้ว 
> โดยไม่ได้เจาะจงว่าอยากให้คุณใช้ editor หรือเครื่องมือที่คุณใช้อยู่ประจำ
> แต่ถ้าคุณคิดว่าอยากจะใช้ IDE แทนคำสั่งที่เตรียมไว้ให้ ก็ตามสบาย เพราะ IDE หลายๆตัวก็น่าจะใช้เขียน Rust ได้อยู่แล้ว 
> ซึ่งคุณอาจจะต้องอ่านเอกสารเพิ่มเติมของ IDE ที่คุณจะใช้เองนะ
> นั่นเพราะว่าทีมงานของเราเร่งทำมันขึ้นมานั่นเองแหล่ะ

### Creating a Project Directory

คุณอาจจะอยากเริ่มด้วยการสร้างไดเร็คทอรี่ ไว้เก็บโค้ดของ Rust แต่นั่นไม่สลักสำคัญอะไรสำหรับ Rust ว่าคุณอยากจะเก็บโค้ดไว้ที่ไหน แต่สำหรับการทำแบบฝึกหัดต่างๆและการทำโปรเจ็คในหนังสือเล่มนี้
เราแนะนำว่าคุณควรสร้างไดเร็คทอรี่ *projects* ไว้ที่ home ไดเร็คทอรี่ แล้วเก็บโปรเจ็คไว้ในนั้น

คราวนี้ให้คุณเปิดโปรแกรมเทอมินัลขึ้นมา แล้วพิมพ์ตามนี้ เพื่อสร้างไดเร็คทอรี่ *projects*
และสร้างอีกได้เร็คทอรี่สำหรับโปรเจ็ค Hello, world! ไว้ใน *projects* อีกที

สำหรับ Linux, macOS และ PowerShell บน Windows ให้พิมพ์ตามนี้:

```text
$ mkdir ~/projects
$ cd ~/projects
$ mkdir hello_world
$ cd hello_world
```

สำหรับ CMD บน Windows ให้พิมพ์ตามนี้:

```cmd
> mkdir "%USERPROFILE%\projects"
> cd /d "%USERPROFILE%\projects"
> mkdir hello_world
> cd hello_world
```

### Writing and Running a Rust Program

จากนั้นให้สร้างไฟล์ซอสโค้ดชื่อ *main.rs* โดยไฟล์ของ Rust จะมีนามสกุล *.rs* เสมอ และถ้าคุณอยากจะตั้งชื่อที่มีมากกว่าหนึ่งคำในชื่อไฟล์ ขอให้ใช้ขีดล่างเพื่อแบ่งแต่ละคำ ตัวอย่างเช่น *hello_world.rs* แทนที่จะใช้ *helloworld.rs*

เสร็จแล้วก็เปิดไฟล์ *main.rs* ขึ้นมาแล้วเขียโค้ดตาม Listing 1-1

<span class="filename">Filename: main.rs</span>

```rust
fn main() {
    println!("Hello, world!");
}
```

<span class="caption">Listing 1-1: โปรแกรมแสดงคำว่า `Hello, world!`</span>

เขียนเสร็จแล้วก็บันทึกไฟล์แล้วกลับไปที่เทอร์มินัล แล้วพิมพ์ตามนี้สำหรับเครื่องที่เป็น Linux และ macOS เพื่อคอมไพล์และรันโปรแกรม:

```text
$ rustc main.rs
$ ./main
Hello, world!
```

บนวินโดวส์ให้เปลี่ยนจาก `.\main.exe` เป็น `./main` แทน:

```powershell
> rustc main.rs
> .\main.exe
Hello, world!
```

ไม่ว่าจะใช้ระบบปฏิบัติการไหนตอนนี้ คุณควรจะเห็นประโยค `Hello, world!` บนหน้าจอเทอร์มินัลแล้วนะ แต่ถ้าคุณไม่เห็น ให้ย้อนกลับไปดู [“Troubleshooting”][troubleshooting]<!-- ignore --> ในเรื่องการติดตั้ง นั่นอาจจะพอช่วยคุณได้

ถ้าคุณเห็นประโยค `Hello, world!` แล้วละก็ ขอแสดงความยินดีด้วย คุณได้เขียนโปรแกรมด้วย Rust อย่างเป็นทางการเรียบร้อยแล้ว นั่นจะทำให้คุณเริ่มเป็นพวกเราแล้ว

### Anatomy of a Rust Program

เรามาลองพิจารณาในรายละเอียดว่าเกิดอะไรขึ้นในโปรแกรม Hello, world! กันดีกว่า
และนี่คือจิกซอตัวแรก

```rust
fn main() {

}
```

บรรทัดนี้เป็นการสร้างฟังก์ชั่นในภาษา Rust โดยฟังก์ชั่น `main` มีความพิเศษตรงที่: มันเป็นฟังก์ชั่นแรกที่จะถูกเรียกขึ้นมาทำงานเสมอ
ซึ่งมันถูกประกาศขึ้นมาโดยไม่มีพารามิเตอร์ และไม่คืนค่าอะไรเลย แต่ถ้ามันจะมีพารามิเตอร์ เราก็จะเห็นมันอยู่ในวงเล็บ `()` นั่นแหล่ะ

และอีกอย่างนึงก็คือ ส่วนตัวฟังก์ชั่นจะครอบด้วยวงเล็บปีกกา `{}` นะ ซึ่งภาษา Rust บังคับว่าต้องเขียนครอบฟังก์ชั่นไว้ และมันจะดีถ้าเราเอาวงเล็บเปิดไว้บรรทัดเดียวกันกับตอนประกาศฟังก์ชั่น เว้นวรรคสักหนึ่งที จะงดงามมากๆ

ในขณะที่เขียนหนังสือนี้ ตัวจัดการฟอร์แมตอัตโนมัติที่เรียกว่า `rustfmt` กำลังอยู่ในระหว่างการพัฒนา ถ้าคุณต้องการให้ทุกโปรเจ็คมีมาตรฐานเดียวกัน `rustfmt` จะจัดระเบียบโค้ดให้คุณได้ และทีมของเรามีแผนจะรวมเจ้าตัวนี้เข้าไปในชุดเครื่องมือมาตรฐานอย่าง `rustc` เป็นต้น ซึ่งบางทีตอนที่คุณกำลังอ่านหนังสือนี้อยู่ มันอาจจะถูกติดตั้งไว้แล้วก็เป็นได้ ลองตรวจสอบเอกสารออนไลน์ดูอีกทีสำหรับรายละเอียด

ในฟังก์ชั่น `main` ตามมาด้วยโค้ดนี้:

```rust
    println!("Hello, world!");
```

บรรทัดนี้เป็นบรรทัดที่ทำงานจริงๆของโปรแกรมเล็กๆนี้ มันพิมพ์ตัวหนังสือลงไปบนหน้าจอ ซึ่งมีรายละเอียดสำคัญ 4 ประการ ประการแรกเราจะเห็นการใช้เว้นช่องว่าง 4 ตัวแทนการใช้แท็บ

ประการที่สอง `println!` เป็นการเรียกมาโครของ Rust ซึ่งถ้าเป็นการเรียกฟังก์ชั่น มันจะกลายเป็นแบบนี้ `println` แทน (โดยไม่มีเครื่องหมาย `!`) เดี๋ยวเราจะมาพูดถึงประเด็นนี้ในเรื่อง Rust macros ในบทที่ 19 กันอีกที แต่สำหรับตอนนี้ เราแค่ต้องรู้ว่าการใช้ `!` หมายถึงการเรียกใช้มาโคร ไม่ใช่การเรียกฟังก์ชั่นปกติ

ประการที่สาม เราเห็น `"Hello, world!"` ถูกส่งเป็นอากิวเมนต์ให้กับ `println!` และเป็นประโยคที่ถูกพิมพ์ออกมาบนหน้าจอ

ประการที่สี่ เราจะจบบรรทัดด้วยเครื่องหมายเซมิโคลอน (`;`) เพื่อบอกให้รู้ว่าจบคำสั่งและพร้อมเริ่มคำสั่งถัดไปแล้ว ซึ่งโค้ดส่วนมากของ Rust ก็มักจะปิดท้ายด้วยเซมิโคลอนนี้

### Compiling and Running Are Separate Steps

คุณเพิ่งจะลองรันโปรแกรมที่สร้างมาใหม่เมื่อกี้ ทีนี้เราลองมาดูแต่ละขั้นตอนกันอีกที

ก่อนที่จะรันโปรแกรมของ Rust ทุกครั้ง คุณต้องคอมไพล์มันก่อนด้วยคอมไพเลอร์ ด้วยการพิมพ์คำสั่ง `rustc` แล้วส่งชื่อไฟล์ที่เป็นซอสโค้ดให้มันแบบนี้:

```text
$ rustc main.rs
```

ถ้าคุณเคยเขียน C หรือ C++ มาก่อน คุณจะเห็นว่ามันเหมือนกับ `gcc` หรือ `clang` โดยหลังจากคอมไพล์เสร็จ Rust จะสร้างไบนารี่ไฟล์หนึ่งสำหรับเอาไปเรียกใช้งานได้เลย

บน Linux, macOS และ PowerShell บนวินโดวส์ คุณสามารถดูไฟล์นี้ได้ด้วยคำสั่ง `ls` โดยถ้าเป็น Linux กับ macOS คุณจะเห็นสองไฟล์ แต่บนวินโดวส์ คุณจะเห็นสามไฟล์

```text
$ ls
main  main.rs
```

สำหรับบนวินโดวส์ให้พิมพ์คำสั่งตามนี้:

```cmd
> dir /B %= the /B option says to only show the file names =%
main.exe
main.pdb
main.rs
```

มันแสดงให้เห็นไฟล์ซอสโค้ดที่มีนามสกุล *.rs* ไฟล์สำหรับรัน (*main.exe* บนวินโดวส์ แต่จะเห็นเป็น *main* สำหรับแพลฟอร์มอื่น) และถ้าเป็นบนวินโดวส์ จะเพิ่มไฟล์ *.pdb* ที่เป็นข้อมูลการดีบั๊กมาให้ด้วย และจากจุดนี้คุณสามารถรันโปรแกรม *main* หรือ *main.exe* ได้ด้วยการทำแบบนี้:

```text
$ ./main # or .\main.exe on Windows
```
ถ้าไฟล์ *main.rs* เป็นโปรแกรม Hello, world! ของคุณ มันควรจะพิมพ์
`Hello,
world!` ขึ้นมาบนเทอมินอล

ถ้าคุณถนัดภาษาพวกที่เป็นไดนามิคเช่น Ruby, Python หรือ JavaScript คุณอาจจะไม่ต้องคอมไพล์โปรแกรมก่อนรัน ซึ่งต้องทำหลายขั้นตอน ซึ่ง Rust เป็นภาษาที่ต้องคอมไพล์ก่อน หมายความว่า เมื่อคุณเอาโปรแกรมที่คอมไพล์แล้วให้ใครสักคนไปใช้งาน เขาสามารถรันมันได้ทันที แต่ถ้าคุณเอาไฟล์ *.rb*, *.py* หรือ *.js* ให้เขา เขาจะต้องติดตั้ง Ruby, Python หรือ JavaScript (ตามลำดับ) ไว้ในเครื่องเขาก่อน ถึงจะรันโปรแกรมได้ แต่มันก็ง่ายกว่าตอนรัน เพราะใช้แค่คำสั่งเดียว ซึ่งก็ได้อย่างเสียอย่าง

แค่การคอมไพล์ด้วย `rustc` อาจจะดีสำหรับโปรแกรมง่ายๆ แต่ถ้าโปรเจ็คคุณมันโตขึ้น คุณอาจจะอยากจะจัดการเรื่องการแชร์โค้ดให้ง่ายกว่านี้ ตอนต่อไป เราจะนำคุณไปสู่ Cargo เครื่องมือที่จะมาช่วยให้คุณเขียนโปรแกรม Rust ในโลกแห่งความเป็นจริงกัน

[troubleshooting]: ch01-01-installation.html#troubleshooting
